"use strict";angular.module("songtabcreatorApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/tabs.html",controller:"TabCtrl"}).when("/chord_dictionary",{templateUrl:"views/chord_dictionary.html",controller:"ChordDictionaryCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("songtabcreatorApp").controller("TabCtrl",["$scope","Chords",function(a,b){function c(b){angular.forEach(a.editRow.cells,function(c,d){var e=d.split("-"),f=e[0],g=parseInt(e[1]),h=b>-1?g<a.columnCount:g>1,i=a.editRow.cells[f+"-"+(g+b)];h&&void 0===i&&(a.editRow.cells[f+"-"+(g+b)]=c,delete a.editRow.cells[d])})}function d(b){a.editRow=a.tabRows[b]}function e(a){return"E"!==a?g[g.indexOf(a)+1]:a}function f(a){return"chords"!==a?g[g.indexOf(a)-1]:a}a.Chords=b,a.columnCount=110,a.spacing={tab:4,measure:4},a.tabRows=[{cells:{},lyrics:""}],a.clearRow=function(){a.editRow.cells={}},a.shiftLeft=function(){c(-1)},a.shiftRight=function(){c(1)},d(0),a.activeEditRow=function(){d(this.$index)},a.addTabRow=function(){a.tabRows.push({cells:{},lyrics:""}),d(a.tabRows.length-1)},a.highlightView=function(a){var b=angular.element.find(".tab-view .active-row ul.chord")[this.column-1];b.style.background=a};var g=["chords","e","b","g","d","a","E"];a.navigateTab=function(b){var c=b.keyCode,d=b.target.name.split("-"),g=d[0],h=parseInt(d[1]),i=[9,13,37,38,39,40];-1!==i.indexOf(c)&&(b.preventDefault(),(9===c||39===c)&&h<a.columnCount&&angular.element.find('.editor input[name="'+g+"-"+(h+parseInt(a.spacing.tab))+'"')[0].focus(),(b.shiftKey&&9===c||37===c)&&h>1&&angular.element.find('.editor input[name="'+g+"-"+(h-parseInt(a.spacing.tab))+'"')[0].focus(),(13===c||40===c)&&angular.element.find('.editor input[name="'+e(g)+"-"+h+'"')[0].focus(),(b.shiftKey&&13===c||38===c)&&angular.element.find('.editor input[name="'+f(g)+"-"+h+'"')[0].focus())};var h=function(){a.editRow.cells["chords-"+this.column]=a.editRow.cells["chords-"+this.column][0].toUpperCase()+a.editRow.cells["chords-"+this.column].slice(1)},i=function(b){b?(a.editRow.cells["e-"+this.column]=b[5],a.editRow.cells["b-"+this.column]=b[4],a.editRow.cells["g-"+this.column]=b[3],a.editRow.cells["d-"+this.column]=b[2],a.editRow.cells["a-"+this.column]=b[1],a.editRow.cells["E-"+this.column]=b[0]):(a.editRow.cells["e-"+this.column]="",a.editRow.cells["b-"+this.column]="",a.editRow.cells["g-"+this.column]="",a.editRow.cells["d-"+this.column]="",a.editRow.cells["a-"+this.column]="",a.editRow.cells["E-"+this.column]="")};a.lookupChord=function(){if(""===a.editRow.cells["chords-"+this.column])return void i.call(this);if(!isNaN(a.editRow.cells["chords-"+this.column]))return void(a.editRow.cells["chords-"+this.column]="");h.call(this);var c=b[a.editRow.cells["chords-"+this.column]];void 0!==c?i.call(this,c):i.call(this)},a.saveToText=function(){var b=[];angular.forEach(a.tabRows,function(c){for(var d in g){var e=[],f="-";"chords"===g[d]&&(f=" ");for(var h=1;h<a.columnCount;h++){var i=c.cells[g[d]+"-"+h]||f;e.push(i)}b.push(e.join(""))}}),b=b.join("\r\n");var c=document.createElement("a");document.body.appendChild(c);var d=new Blob([b],{type:"text/plain"});c.href=window.URL.createObjectURL(d),c.download="fileName.txt",c.click()},a.buildArray=function(a){for(var b=new Array(a),c=1;c<=b.length;c++)b[c-1]=c;return b}}]),angular.module("songtabcreatorApp").controller("ChordDictionaryCtrl",["$scope","Chords",function(a,b){a.Chords=b,a.splitChord=function(a){return a.join("-")}}]),angular.module("songtabcreatorApp").factory("Chords",function(){var a={"|":["|","|","|","|","|","|"],A:["X","0","2","2","2","0"],A6:["0","0","2","2","2","2"],A7:["X","0","2","0","2","0"],A9:["X","0","2","4","2","3"],Aaug:["X","0","3","2","2","1"],Ab:["4","6","6","5","4","4"],Ab6:["4","3","1","1","1","1"],Ab7:["X","X","1","1","1","2"],Ab9:["X","X","1","3","1","2"],Abar:["5","7","7","6","5","5"],Abaug:["X","X","2","1","1","0"],Abmaj7:["X","X","1","1","1","3"],Absus:["X","X","1","1","2","4"],Adim:["X","X","1","2","1","2"],Am:["X","0","2","2","1","0"],Am6:["0","0","2","2","1","2"],Am7:["0","0","2","0","1","0"],"Am7/F#":["2","0","2","2","1","0"],"Am7/G":["3","0","2","0","1","0"],Asus:["X","X","2","2","3","0"],B:["2","2","4","4","4","2"],B6:["2","2","4","4","4","4"],B7:["X","2","1","2","0","2"],B9:["X","2","1","2","2","2"],Baug:["X","X","6","5","5","4"],Bb:["X","1","3","3","3","1"],Bb6:["1","1","3","3","3","3"],Bb7:["X","X","4","4","4","5"],Bb9:["1","1","3","1","1","1"],Bbaug:["X","X","0","3","3","2"],Bbdim:["X","X","2","3","2","3"],Bbm:["X","1","3","3","2","1"],Bbm6:["X","X","3","3","2","3"],Bbm7:["X","X","3","3","2","4"],Bbmaj7:["X","1","3","2","3","X"],Bbsus:["X","X","3","3","4","1"],Bm:["2","2","4","4","3","2"],Bm6:["X","X","6","6","5","6"],Bm7:["X","2","4","2","3","2"],Bsus:["X","X","5","5","6","3"],C:["X","3","2","0","1","0"],"C#m":["X","X","2","1","2","0"],"C#6":["X","X","2","3","2","4"],"C#7":["X","X","2","4","2","4"],"C/B":["X","2","2","X","1","0"],"C/G":["3","3","2","0","1","0"],C6:["X","3","2","2","1","0"],C7:["X","3","2","3","1","0"],C9:["X","3","2","3","3","3"],Caug:["X","X","2","1","1","0"],Cm:["3","3","5","5","4","3"],Cm6:["X","X","1","2","1","3"],Cm7:["X","X","1","3","1","3"],Cmaj7:["X","3","2","0","0","0"],Csus:["X","X","3","0","1","3"],D:["X","X","0","2","3","2"],D6:["X","0","0","2","0","2"],D7:["X","X","0","2","1","2"],"D7/F":["2","X","0","2","1","2"],D9:["2","0","0","2","1","0"],Daug:["X","X","0","3","3","2"],Db:["X","X","3","1","2","1"],Db6:["X","X","3","4","2","4"],Db9:["X","4","3","4","4","4"],Dbaug:["X","X","3","2","2","1"],Dbmaj7:["X","4","3","1","1","1"],Dbsus:["X","X","3","3","4","1"],Dm:["X","X","0","2","3","1"],"Dm/C#":["X","X","0","2","2","1"],Dm6:["X","X","0","2","0","1"],Dm7:["X","X","0","2","1","1"],Dmaj7:["X","X","0","2","2","2"],Dsus:["X","X","0","2","3","3"],E:["0","3","3","2","0","0"],E6:["0","2","2","1","2","0"],E7:["0","2","0","1","0","0"],E9:["0","2","0","1","0","2"],Eb:["X","0","6","4","5","4"],Eb6:["X","X","1","3","1","3"],Eb7:["X","X","1","3","2","3"],Eb9:["1","1","1","3","2","1"],Ebaug:["X","X","1","0","0","3"],Ebm:["X","X","4","3","4","2"],Ebm6:["X","X","1","3","1","2"],Ebm7:["X","X","1","3","2","2"],Ebmaj7:["X","X","1","3","3","3"],Ebsus:["X","X","1","3","4","4"],Em:["0","2","2","0","0","0"],Em6:["0","2","2","0","2","0"],Em7:["0","2","2","0","3","0"],Emaj7:["0","2","1","1","0","X"],Esus:["0","2","2","2","0","0"],F:["1","3","3","2","1","1"],"F#":["2","4","4","3","2","2"],"F#7":["X","X","4","3","2","0"],"F#9":["X","X","5","4","6","5"],"F#m":["2","4","4","2","2","2"],"F#6":["X","X","1","2","2","2"],F6:["X","X","0","2","1","1"],F7:["1","3","1","2","1","1"],F9:["X","X","3","2","4","3"],Faug:["X","X","3","2","2","1"],Fm:["1","3","3","1","1","1"],Fm6:["X","X","0","1","1","1"],Fm7:["1","3","1","1","1","1"],Fmaj7:["0","X","3","2","1","0"],Fsus:["X","X","3","3","1","1"],G:["3","2","0","0","3","3"],"G#m":["4","6","6","4","4","4"],"G#6":["X","X","3","4","4","4"],"G#7":["X","X","1","1","0","2"],"G/B":["3","2","0","0","0","3"],G6:["3","2","0","0","3","0"],G7:["3","2","0","0","0","1"],G9:["3","0","0","2","0","1"],Gaug:["X","X","1","0","0","3"],Gb6:["X","4","4","3","4","X"],Gbaug:["X","X","4","3","3","2"],Gbmaj7:["X","X","4","3","2","1"],Gbsus:["X","X","4","4","2","2"],Gm:["3","5","5","3","3","3"],Gm6:["X","X","2","3","3","3"],Gm7:["3","5","3","3","3","3"],Gmaj7:["3","2","0","0","0","2"],Gsus:["X","X","0","0","1","3"]};return a}),angular.module("songtabcreatorApp").run(["$templateCache",function(a){a.put("views/chord_dictionary.html",'<div class="chord-dictionary"> <div ng-repeat="(name, chord) in Chords"> <div class="display-chord"> <span class="chord-name">{{name}}:</span> <span>{{splitChord(chord)}}</span> </div> </div> </div>'),a.put("views/tabs.html",'<div class="tabs"> <div class="actions"> <div class="row-adjust"> <button class="btn btn-default" ng-click="addTabRow()">Add Tab Row</button> <button class="btn btn-default" ng-click="clearRow()">Clear Row</button> <button class="btn btn-default" ng-click="shiftLeft()">Shift Left</button> <button class="btn btn-default" ng-click="shiftRight()">Shift Right</button> </div> <div class="spacing"> <div class="tab"> <label>Tab Spacing</label><input class="form-control" type="text" ng-model="spacing.tab"> </div> <!--  GET TO THIS LATER      <div class=\'measure\'>\n        <label>Measure Spacing</label><input class=\'form-control\' type=\'text\' ng-model=\'spacing.measure\'>\n      </div> --> </div> <div class="print-text"> <button class="btn btn-default" ng-click="saveToText()">Save Tab!</button> </div> </div> <div class="editor"> <ul class="row-names"> <li>Chord</li> <li>e</li> <li>b</li> <li>g</li> <li>d</li> <li>a</li> <li>E</li> </ul> <div class="chord-columns" ng-keydown="navigateTab($event)"> <ul class="chord" ng-class="{&quot;tabspace-mod&quot;: spacing.tab > 1 && column % spacing.tab === 0}" ng-mouseover="highlightView(&quot;lightblue&quot;)" ng-mouseleave="highlightView(&quot;none&quot;)" ng-repeat="column in buildArray(columnCount)"> <li class="chord-name"><input ng-change="lookupChord()" type="text" name="{{&quot;chords-&quot;+column}}" ng-model="editRow.cells[&quot;chords-&quot;+column]"></li> <li class="e-string"><input type="text" name="{{&quot;e-&quot;+column}}" ng-model="editRow.cells[&quot;e-&quot;+column]"></li> <li class="b-string"><input type="text" name="{{&quot;b-&quot;+column}}" ng-model="editRow.cells[&quot;b-&quot;+column]"></li> <li class="g-string"><input type="text" name="{{&quot;g-&quot;+column}}" ng-model="editRow.cells[&quot;g-&quot;+column]"></li> <li class="d-string"><input type="text" name="{{&quot;d-&quot;+column}}" ng-model="editRow.cells[&quot;d-&quot;+column]"></li> <li class="a-string"><input type="text" name="{{&quot;a-&quot;+column}}" ng-model="editRow.cells[&quot;a-&quot;+column]"></li> <li class="E-string"><input type="text" name="{{&quot;E-&quot;+column}}" ng-model="editRow.cells[&quot;E-&quot;+column]"></li> <li class="column-index">{{column}}</li> </ul> </div> </div> <div class="tab-view"> <div class="chord-columns" ng-repeat="row in tabRows" ng-click="activeEditRow()" ng-class="{ &quot;active-row&quot;: editRow == row }"> <div class="tablature"> <ul class="row-names"> <li>&nbsp</li> <li>e |</li> <li>b |</li> <li>g |</li> <li>d |</li> <li>a |</li> <li>E |</li> <!-- The </ul> tag is broken here on purpose because of dumb CSS things --> </ul><ul class="chord" ng-repeat="column in buildArray(columnCount)"> <li class="chord-name">{{row.cells[\'chords-\'+column] || \'&nbsp\'}}</li> <li class="e-string">{{ row.cells[\'e-\'+column] || \'-\' }}</li> <li class="b-string">{{ row.cells[\'b-\'+column] || \'-\' }}</li> <li class="g-string">{{ row.cells[\'g-\'+column] || \'-\' }}</li> <li class="d-string">{{ row.cells[\'d-\'+column] || \'-\' }}</li> <li class="a-string">{{ row.cells[\'a-\'+column] || \'-\' }}</li> <li class="E-string">{{ row.cells[\'E-\'+column] || \'-\' }}</li> </ul> <div class="lyrics"><input type="text" ng-model="row.lyrics" placeholder="Lyrics go here!"></div> </div> </div> </div> </div>')}]);